= ロギング
:navtitle: ロギング

include::vars.adoc[]

OpenShiftは、アプリケーションログを表示するための便利なメカニズムをいくつか提供しています。 まず最も重要なのは、Webコンソールまたはコマンドラインから *Pod* のログを直接確認できることです。

[#container_logs]
== 背景: コンテナログ

OpenShiftは、コンテナがすべての情報を `STDOUT` にログ出力することを期待しています。 このようにして、通常の情報とエラー情報の両方が
標準化されたメカニズムを介してキャプチャされます。 *Pod* のログを
直接確認する場合、基本的にはコンテナランタイムを介してコンテナのログにアクセスし、
それをOpenShiftのAPIを通じて行っています。

[NOTE]
====
アプリケーションによっては、すべての情報を `STDOUT` や `STDERR` に送信するように
設計されていない場合があります。 多くの場合、複数のローカルログファイルが
使用されます。OpenShiftはこれらのファイルから情報を解析することはできませんが、
それらが作成されることを妨げるものはありません。 他のケースでは、ログ情報は
何らかの外部システムに送信されます。OpenShiftはこれらの動作を禁止しません。
すでにログ情報を何らかの外部システムに送信しているか、
またはログ情報をさまざまなファイルに書き込んでいるために `STDOUT` にログを出力しないアプリケーションがあっても、
心配しないでください - OpenShiftはそれでも動作します。
====

[#examining_logs]
== 演習: ログの確認

すでにアプリケーションをデプロイしたので、そのログを確認できます。
*Topology*（トポロジー）ビューで、`parksmap` エントリをクリックし、*Resources*（リソース）タブをクリックします。
*Pod* エントリの横に *View Logs*（ログの表示）リンクが表示されるはずです。

[.bordershadow]
image::parksmap-view-logs-link.png[link="self",window=_blank]

*View Logs*（ログの表示）リンクをクリックして、*Pod* のログを表示します：

[.bordershadow]
image::parksmap-logging-console-logs.png[link="self",window=_blank]

WARNING: ログにいくつかのエラーが表示されても、問題ありません。
それらは後ほど修正します。

コマンドラインからログを表示するオプションもあります。
`oc logs` コマンドを使用し、ラベルセレクターを渡して、セレクターに一致するすべてのPodのログを表示します：

[source,role="copypaste"]
----
oc logs -l app=parksmap
----

アプリケーションのログが表示されます：

[.console-output]
[source]
----
2019-05-22 19:37:01.433  INFO 1 --- [           main] o.s.m.s.b.SimpleBrokerMessageHandler     : Started.
 2019-05-22 19:37:01.465  INFO 1 --- [           main] s.b.c.e.t.TomcatEmbeddedServletContainer : Tomcat started on port(s): 8080 (http)
2019-05-22 19:37:01.468  INFO 1 --- [           main] c.o.evg.roadshow.ParksMapApplication     : Started ParksMapApplication in 3.97 seconds (JVM running
 for 4.418)
2019-05-22 19:38:00.762  INFO 1 --- [MessageBroker-1] o.s.w.s.c.WebSocketMessageBrokerStats    : WebSocketSession[0 current WS(0)-HttpStream(0)-HttpPoll(
0), 0 total, 0 closed abnormally (0 connect failure, 0 send limit, 0 transport error)], stompSubProtocol[processed CONNECT(0)-CONNECTED(0)-DISCONNECT(0)]
, stompBrokerRelay[null], inboundChannel[pool size = 0, active threads = 0, queued tasks = 
 0, completed tasks = 0], outboundChannel[pool size = 0, active
 threads = 0, queued tasks = 0, completed tasks = 0], sockJsScheduler[pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0]
2019-05-22 19:44:11.517  INFO 1 --- [nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring FrameworkServlet 'dispatcherServlet'
2019-05-22 19:44:11.517  INFO 1 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : FrameworkServlet 'dispatcherServlet': initialization sta
rted
2019-05-22 19:44:11.533  INFO 1 --- [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : FrameworkServlet 'dispatcherServlet': initialization com
pleted in 16 ms
2019-05-22 19:44:13.395  INFO 1 
 --- [nio-8080-exec-2] c.o.e.roadshow.rest.BackendsController   : Backends: getAll
----

WARNING: ログをスクロールすると、サービスアカウントに関連するエラーに気付くかもしれません。
それは何でしょうか？ 心配しないでください、それについては後ほど学びます。